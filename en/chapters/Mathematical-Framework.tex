\chapter{"Mathematical framework"}
\todo[inline]{vymyslet lepší název kapitoly}

In this chapter we shall revise some basic definitions and propositions of the functional calculus, which we will need for the proper formulation of the hydrodynamic geometry. Most of the existing literature on this topic often lacks clarity due to the omittance of certain details. This can include the domains on which functionals are defined or regularity conditions.

Over the last century, modern mathematics has worked to develop the theory of generalized functions - distributions, including Dirac's delta distributions and operations with them, such as in [CITATION]. The same applies to functional variations and the conditions on which they exist. 
Among physists, however, it is convential to operate with delta distributions as they would with "ordinary" functions, using dualities as integrals and functional variations as ordinary derivatives.


After introducing the concept of Gateaux and Frechet derivatives, which are suitable for arbitrary normed space, we shall take a closer look on the space of smooth functions and functionals on it.

\section{Functional derivatives}

\todo[inline]{přidat nějaký kontext}

\begin{definition}[Gateaux and Frechet derivative]
    Let $X$ be a normed space, $A: X \to \R$ is a functional and $x \in D(A)$.
    \begin{enumerate}
        \item Gateaux derivative $\delta A(x,h)$ in the direction $h$ is defined as
        \begin{align}
            \delta A (x,h) = \der{}{t} A(x+th) |_{t=0} = \lim_{t \rightarrow 0} \frac{A(x+th)-A(x)}{t} \:.
        \end{align}

        \item Fréchet derivative $DA(x)$ is defined as the unique linear bounded functional satisfying the relation
        \begin{align}
            \lim_{h \rightarrow 0} \frac{A(x+h)-A(x)- DA(h)}{\norm{h}} = 0 \:.
        \end{align}
    \end{enumerate}
\end{definition}

We are intersted in such functionals, where $X$ is the subspace of functions $ f \in C^k(\Omega)$, $\Omega$ is a subset of $\R^n$, satisfying $f,f',\cdots,f^{(k-1)} = 0$ on $\partial \Omega$, equipped with the norm
\begin{align}
    \norm{u}_X = \sum_{j=1}^n \sup_{x \in \Omega} |u^{(j)}(x)| \:.
\end{align}
There are two main types of functionals on that space. 

\subsection{Integral functionals}

The first type is the integral functional
\begin{align}
    A[u] = \int_\Omega a(x,u(x),u'(x),\cdots,u^{(k)}(x)) \, \D^n x \:, \label{eq:integral-functional}
\end{align}
where $a : \R \times \R^{k} \to \R$ is an analytic function.
For simplicity we often write this using a physical notation
\begin{align}
    A[u] = \int a(u) \, \D^n x \:,
\end{align}
meaning that $a(u)$ is in fact function $a(x,u(x),u'(x),\cdots, u^{(k)}(x))$ and also the domain $\Omega$ is specified by the context. We call $a(u)$ the density of functional $A[u]$.

Gateaux derivative of $A$ is computed as follows:
\begin{align}
    \delta A[u,h] = \int_\Omega \sum_{i=1}^k \pder{a}{u^{(i)}}(x) h^{(i)}(x) \, \D^n x \:. \label{eq:Gateaux}
\end{align}
The functional $\delta A[u,h]$ is linear and bounded in $h$, so the Fréchet derivative of $A$ exists and is given by
\begin{align}
    DA[u] \cdot h = \delta A[u,h] \:.
\end{align}
To get rid of the derivatives of $h(x)$ in \eqref{eq:Gateaux}, we use integration by parts in each term of the sum, obtaining
\begin{align}
    DA[u] \cdot h = \int_\Omega \left[ \pder{a}{u}(x) - \der{}{x} \pder{a}{u'}(x) + \der{^2}{x^2} \pder{a}{u''}(x) - \cdots + (-1)^k \der{^k}{x^k} \pder{a}{u^{(k)}}(x) \right] h(x) \, \D^n x \:. \label{eq:perpartes}
\end{align}

It is natural to give a special name to the integrand in \eqref{eq:perpartes}.

\begin{definition}[Functional derivative]
    Let $A$ be the integral functional given by \eqref{eq:integral-functional}. The functional derivative o $A$ is the function
    \begin{align}
        \fder{A}{u(x)} = \pder{a}{u}(x) - \der{}{x} \pder{a}{u'}(x) + \der{^2}{x^2} \pder{a}{u''} - \cdots + (-1)^n \der{^k}{x^k} \pder{a}{u^{(k)}}(x) \:.
    \end{align}
\end{definition}

The expression \eqref{eq:perpartes} is very similar to the scalar product on $L^2(\Omega)$ given by
\begin{align}
    \dual{f}{g}_{L^2(\Omega)} = \int_\Omega f(x) g(x) \, \D x \:.
\end{align}
Thus, it makes sense to write
\begin{align}
    DA[u] \cdot h = \int_\Omega \fder{A}{u(x)} h(x) \, \D x = \dual{\fder{A}{u(x)}}{h(x)} \:.
\end{align}



It follows from theory (CITATION) that the functional derivative beeing zero is a necessery condition for the function beeing the extremal point of the functional (given that the corresponding function is smooth enough).

\begin{theorem}[Euler-Lagrange equations]
    Let $v \in C^\infty(\Omega)$ such that $v(x)$ is stationary point of the functional $A$ in \eqref{eq:integral-functional}, i.e
    \begin{align}
        \delta A[v,h] = 0 \:.
    \end{align}
    Then  
    \begin{align}
        \fder{A}{v(x)} = 0 \:.
    \end{align}
\end{theorem}

The computation above gives sense to the 
\begin{align}
    A[u+h] = A[u] + \dual{\fder{A}{u}}{h} + o(h)\:,
\end{align}
where
\begin{align}
    \lim_{\norm{h} \rightarrow 0} \frac{o(h)}{\norm{h}} = 0 \:.
\end{align}
In physical notation, the function $h$ is often denoted as $\delta u$.


\subsection{Distributions}

\begin{definition}[Distributions]
    Let $\test(\Omega)$ be the space of functions with compact support in $\Omega \subseteq \R^n$. The space of distributions $\dis(\Omega)$ is the dual space, i.e. the space of bounded linear functionals on $\test(\Omega)$. An element $T \in \dis(\Omega)$ is called a distribution.
\end{definition}

\begin{definition}[Regular distribution]
    Let $a \in L^1_{\text{loc}}(\Omega)$. A regular distribution is a distribution $T_a \in \dis(\Omega)$ defined as
    \begin{align}
        \dual{T_a}{\phi(x)} = \int_\Omega a(x) \phi(x) \D^n x \:.
    \end{align}
\end{definition}

Note that if two regular distributions satisfy $T_a = T_b$, then $a=b$ almost everywhere and vice versa.

\begin{definition}[Dirac delta distribution]
    Let $y \in \Omega$. The Dirac delta distribution $\delta(x-y)$ is defined as
    \begin{align}
        \dual{\delta(x-y)}{\phi(x)} = \phi(y) \:. 
    \end{align}
\end{definition}


\todo[inline]{Zmínit se o derivaci distribucí a o tom, že se diraci dají testovat klidně $C^1$ funkcemi, takže souvisejí s teorií v minulé kapitole a můžeme aplikovat teorii funkcionálních derivací i na distribuce.}

\begin{definition}[Derivatives of distributions]
    Let $T \in \dis(\Omega)$ be a distribution. We define its derivative by
    \begin{align}
        \dual{D^\alpha T}{\phi} = (-1)^{|\alpha|} \dual{T}{D^\alpha \phi} q \:,
    \end{align}
    where $\alpha$ is a multiindex and
    \begin{align}
        D^\alpha f = \frac{\partial^{|\alpha|} f}{\partial x_1^{\alpha_1} \partial x_2^{\alpha_2} \cdots \partial x^{\alpha_N}_N} \:.
    \end{align}
\end{definition}



Let $a \in C^\infty(\Omega)$. Then it makes sense to define the product of $a$ and arbitrary distribution $T$ by
\begin{align}
    \dual{a T}{\phi} = \dual{T}{a \phi} \:.
\end{align}

In the next chapter we shall frequently use the following identities of the delta distributions, which are written in the next lemma and which we will refer to as the Dirac identities.

\begin{lemma}[Dirac identities] \label{lemma:delta}
    \begin{align}
        f(y) \delta (x-y) =& f(x) \delta(x-y) \:, \\
        f(y) \delta'(x-y) =& f(x) \delta'(x-y) + f'(x) \delta(x-y) \:.
    \end{align}
\end{lemma}
\begin{proof}
    The first relation is trivial.
    Direct calculation gives
    \begin{align*}
        \dual{f(x) \delta'(x-y)}{\psi(x)} 
        =& \dual{\delta'(x-y)}{f(x) \psi(x)} 
         \\ =& -\dual{\delta(x-y)}{f'(x)\psi(x)} - \dual{\delta(x-y)}{f(x)\psi'(x)} 
         \\ =& -f'(y) \psi(y) - f(y) \dual{\delta(x-y)}{\psi'(x)} 
         \\ =& - \dual{f'(x)  \delta(x-y)}{\psi(x)} + f(y) \dual{\delta'(x-y)}{\psi(x)} 
         \\ =& \dual{f(y) \delta(x-y) - f'(x) \delta'(x-y)}{\psi(x)} \:.
    \end{align*}
    Therefore
    \begin{align}
        \dual{f(y) \delta'(x-y)}{\psi(x)} = \dual{f'(x) \delta(x-y)}{\psi(x)} + \dual{f(x) \delta'(x-y)}{\psi(x)} \:.
    \end{align} 
\end{proof}


\todo[inline]{Vysvětlit, jak by se dal matematicky přesněji odvodit vztah $ A(u(x)) = \int A(u(\xi)) \delta (x-\xi) \, \D \xi$ pomocí konvoluce distribucí.}
The function $a(u)$ can be thus identified with a functional $A[u]$ defined by the relation
\begin{align}
    \dual{A[u(x)]}{\phi(x)}  = \dual{a(u(\xi)) \delta(x-\xi)}{\phi(\xi)}
\end{align}
In the physical notation
\begin{align}
    A[u(x)] = \int a(u(\xi)) \delta(x-\xi) \, \D^n \xi \:.
\end{align}
Therefore it is also common not to differentiate between the function itself and its corresponding functional form and denote them by the same letter $A$:
\begin{align}
    A[u(x)] = \int A(u(\xi)) \delta(x-\xi) \, \D^n \xi \:.
\end{align}



\begin{example}
    Let $u(x)$ be a field variable and $F[u(x)]$ a function(al). 
    To compute its functional derivative w.r.t. $u(y)$ in different position $y$, we use the integral expression of $F$
    \begin{align}
        F[u(x)] = \int \D y F(u(y)) \delta (x-y) \:.
    \end{align}
    Its Gateaux diferential is
    \begin{align}
        \delta F[u,h] = \der{}{t} F[u+th]|_{t=0} = \int \D y \pder{F}{u}(y) \delta(x-y) h(y) \:,
    \end{align}
    therefore
    \begin{align}
        \fder{F(u(x))}{u(y)} = \pder{F}{u}(x) \delta(x-y) \:.
    \end{align}
\end{example}

\begin{example}
    In the special case of performing functional derivative w.r.t. the same field but in the different position,
    \begin{align}
        \fder{u^i(x)}{u^j(y)} = \delta^i_j \delta(x-y) \:.   
    \end{align}
\end{example}

\begin{example}
    \begin{align}
        \set{I,J} = \int_\Omega \D x' \int_\Omega \D y' \fder{I}{u^i(x)} P^{ij}(x',y') \fder{J}{u^j(y)} \:,
    \end{align}
    where
    \begin{align}
        I = I[u], \: J = J[u] \:, \quad P^{ij}(x',y') = \alpha^{ij}(x',y') \der{}{x'} \:.
    \end{align}
    Then
    \begin{align}
        \set{u^a(x),u^b y)} = \int_\Omega \D x' \int_\Omega \D y' \delta^a_i \delta(x-x') \alpha^{ij}(x',y') \delta^b_j \delta(y-y') = \alpha^{ab}(x,y) \:.
    \end{align}
\end{example}


\section{Geometrical aspects}
\subsection{Riemannian manifolds and covariant derivative}
\subsection{Lie algebras and Poisson brackets}

