\chapter{Geometry in hydrodynamics}

In this chapter, we shall illustrate the systems of hydrodynamic type with examples.
For the self-consistency of the Chapter 3 we come to the definition once again (Definitions \vref{def:hamiltonian-functional} and \vref{def:hamiltonian-system}), but for now let us just mention that we operate with the systems of quasi-linear partial differential equations in the form
\begin{align}
    \pder{u^i}{t} = \left[ g^{ij \alpha} (u) \ppder{h(u)}{u^j}{u^k} + b_k^{ij \alpha} (u) \pder{h(u)}{u^j} \right] \pder{u^k}{x^\alpha} \:, \quad i = 1, \cdots , N \:, \quad \alpha = 1, \cdots , d \:,
\end{align}
where $u^i = u^i(t,x^1, \cdots, x^N)$ are the field variables and $h(u)$ is the density of the Hamiltonian functional
\begin{align}
    H = \int h(u) \, \D x \:.
\end{align}
We refer to the coefficients $g^{ij \alpha}(u)$ as to the metrics and to $b^{ij \alpha}_k(u)$ as to the connections. If the metric $g^{ij \alpha}$ is nondegenerate, i.e. $\det g^{ij} \neq 0$, then we can define Christoffel symbols by the standard relation \eqref{eq:Levi-Civita-gamma} and they are connected to the functions $b^{ij \alpha}_k$ via
\begin{align}
    b^{ij \alpha}_k = - g^{i s \alpha} \Gamma^{j \alpha}_{sk} \:.
\end{align}
The following examples can be found in \cite{Pavelka}.

\begin{example}[One-dimensional isothermal system] \label{example:1D isothermal}
    The simplest case is the one-dimensional isothermal flow where the Hamiltonian reads as
    \begin{align}
        H = \int h(\rho, m) \, \D x \:,
    \end{align}
    where $\rho$ represents the matter density and $m$ the momentum density. 
    The field variables are $(u^1,u^2) \coloneqq (\rho,m)$.
    The evolution equations (in the Eulerian frame) are
    \begin{align}
        \pder{\rho}{t} =& - \pder{}{x} \left( \rho \pder{h}{m} \right) \:, \\
        \pder{m}{t} =& - \pder{}{x} \left( \rho \pder{h}{\rho} + m \pder{h}{m} \right) \:.
    \end{align}
    The metric $g^{ij}$ is non-degenerate but indefinite and has the form
    \begin{align}
        g^{ij} = -\begin{pmatrix}
            0 &  \rho \\
            \rho &  2 m
        \end{pmatrix} \:,
    \end{align}
    and the connections are zero except for
    \begin{align}
        \Gamma^{m}_{\rho \rho} = \frac{2m}{\rho^2} \:, \quad \Gamma^m_{\rho m} = \Gamma^m_{m \rho} = - \frac{1}{\rho} \:.
    \end{align}
    therefore
    \begin{align}
        b^{\rho m}_\rho = -1 \:, \quad b^{m m}_m = -1 \:,
    \end{align}
    The Christoffel symbols are symmetric in the lower indices, therefore the torsion of the corresponding covariant derivative is zero. One can also easily calculate that the Riemann curvature tensor is zero.
\end{example}

\begin{example}[General one-dimensional system]
    If we include only the entropy $S$ to the system, the metric $g^{ij}$ becomes degenerate. This can be overcome by adding the entropy flux $w$. This leads to the field variables $(u^1,u^2,u^3,u^4) = (\rho,m,s,w) $. The metric has the form
    \begin{align}
        g^{ij} = -\begin{pmatrix}
            0 & \rho & 0 & 0 \\
            \rho & 2m & s & w \\
            0 & s & 0 & 1 \\
            0 & w & 1 & 0
        \end{pmatrix} \:,
    \end{align}
    which is again symmetric, indefinite and non-degenerate.
\end{example}

\begin{example}[Three-dimensional isothermal system]
    In three dimensions, the field variables are $(u^1,u^2,u^3,u^4) = (\rho, m_x,m_y,m_z)$ and there are three metrics of the form
    \begin{align}
        g^{ij x} = -\begin{pmatrix}
            0 &  \rho & 0 & 0 \\
            \rho &  2 m_x &  m_y & m_z \\
            0 & m_y & 0 & 0 \\
            0 & m_z & 0 & 0
        \end{pmatrix}  \:, \\
        g^{ij y} = -\begin{pmatrix}
            0 & 0 & \rho & 0 \\
            0 & 0 & m_x & 0\\
            \rho & m_x & 2m_y & m_z \\
            0 & 0 & m_z & 0
        \end{pmatrix}  \:, \\
        g^{ij z} = -\begin{pmatrix}
            0 & 0 & 0 & \rho \\
            0 & 0 & 0 & m_x \\
            0 & 0 & 0 & m_y \\
            \rho & m_x & m_y & 2 m_z
        \end{pmatrix}  \:.
    \end{align}
    All of them are degenerate. Moreover, arbitrary linear combination
    \begin{align}
        c_x g^{ij x} + c_y g^{ij y} + c_z g^{ij z}
    \end{align}
    is again degenerate, which makes it impossible to define Levi-Civita connection.
\end{example}

\section{Hyperbolicity}

The quasi-linear first order system of the form
\begin{align}
    A^{ij} \pder{u^j}{t} = B^{ij \alpha}(u) \pder{u^j}{x^\alpha}
\end{align}
is called symmetric hyperbolic if the matrix $A^{ij}$ is positive symmetric and $B^{ij \alpha}$ is symmetric in $i,j$ indices for each $\alpha$. If the system is symmetric hyperbolic, then the solution of the initial value problem exists, is unique, and depends continuously on initial data along arbitrary non-characteristic hypersurfaces \cite{Pavelka}. Hyperbolicity is also helpful for various numerical resolutions. More on this topic can be found in \cite{Toro}. 

The usual way to show symmetric hyperbolicity of a system is the Godunov-Boillat theorem \cite{Pavelka}. If the system is written in conservative form
\begin{align}
    \pder{u^i}{t} = - \pder{J^{i \alpha}(u)}{x^\alpha} \:, \label{eq:conservative}
\end{align}
the total energy density $h(u)$ is a convex function of the state variables and if there is an extra conservation law implied by the evolution equations
\begin{align}
    \pder{h}{t} = - \pder{J^{h \alpha}}{x^\alpha} = - \pder{J^{h \alpha}}{u^i} \pder{u^i}{x^\alpha} = - \pder{h}{u^j} \pder{J^{j \alpha}}{u^k} \pder{u^k}{x^\alpha} \:,
\end{align}
then the so called compatibility condition is satisfied:
\begin{align}
    \pder{J^{e \alpha}}{u^i} = \pder{h}{u^j} \pder{J^{j \alpha}}{u^i} \:.
\end{align}
We can then introduce the conjugate variables $p_i$ by the Legendre transformation 
\begin{align}
    p_i \coloneqq \pder{h}{u^i} \:, \quad L \coloneqq - h + p_i u^i \:, \quad u^i \coloneqq \pder{L}{p_i} \:.
\end{align}
Then the evolution equations can be rewritten as
\begin{align}
    \ppder{L}{p_i}{p_j} \pder{p^j}{t} = \ppder{\tilde J^\alpha}{p_i}{p_j} \pder{p^j}{x^\alpha} \:, \quad \tilde J^\alpha \coloneqq - J^{h \alpha}(p) + \pder{h}{u^j} J^{j \alpha}(p) \:,
\end{align}
which is a symmetric hyperbolic system. 

This procedure fails in systems with mixtures. For example, the system
\begin{align}
    g^{ij} = - \begin{pmatrix}
        0 & \rho_1 & 0 & 0 \\
        \rho_1 &  2 m_1  & 0 & 0 \\
        0 & 0 & 0 & \rho_2 \\
        0 & 0 & \rho_2 & 2 m_2
    \end{pmatrix}
\end{align}
does not allow any condition such as \eqref{eq:conservative} \cite{Generic}. For these systems one cannot use the Godunov-Boillat theorem. 

There is an alternative approach, which was shown in \cite{Pavelka} for the \\one-dimensional case. Assuming that one can write the one-dimensional system in the form
\begin{align}
    \pder{u^i}{t} = (g^{is} \nabla_s \nabla_k h) \pder{u^k}{t} \:, \label{eq:nabla-nabla}
\end{align}
then this system can be symmetrized by multiplying it by the covariant Hessian of energy. If we denote
\begin{align}
    e_{ij} \coloneqq \nabla_i \nabla_j h \:,
\end{align}
then we obtain the equations
\begin{align}
    e_{ij} \pder{u^j}{t} = e_{ij} g^{jk} e_{km} \pder{u^m}{x} \:.
\end{align}
In addition, if we assume that the energy $h$ is convex, then $e_{ij}$ is a positive symmetric matrix, which implies the hyperbolicity of such system. In Chapter 3, we show that the possibility of writing the equation \eqref{eq:nabla-nabla} is a direct consequence of the Dubrovin-Novikov theorem, see Theorem \vref{theorem:covariant}. 

If the covariant Hessian of energy is positive definite, the procedure above works, but it is not trivial to show
that convex energy has a positive definite covariant Hessian. Here we present some ideas from \cite{Rapcsak} that could help to shed light on this problem.

\begin{definition}[Geodesic convex set]
    Let $M$ be a smooth manifold. A set $A \subset M$ is said to be geodesic convex if any two points of $A$ are joined by a geodesic belonging to $A$.
\end{definition}

\begin{definition}[Geodesic convex function]
    Let $A \subset M$ be a geodesic convex set. The function $f : A \to \R$ is said to be geodesic convex if its restrictions to all geodesic arcs belonging to $A$ are convex in the arc length parameter.
\end{definition}

If $f$ is a geodesic convex function, $\gamma(s)$ is a geodesic curve, $s \in [0,b]$, joining the two arbitrary points $m_1, m_2 \in A$, $\gamma(0) = m_1$, $\gamma(b) = m_2$, and $s$ is the arc length parameter, then the following inequality holds:
\begin{align}
    f(\gamma(tb)) \leq (1-t) f(\gamma(0)) + t f(\gamma(b)) \:, \quad 0 \leq t \leq 1 \:.
\end{align}

\begin{theorem}[Geodesic convexity; \cite{Rapcsak}]
    The geodesic convexity of a function $f : M \to \R$ coincides with the convexity in a coordinate neighborhood of every point if and only if the manifold $M$ has a constant curvature, that is, in the cases of Euclidean geometries, Riemannian elliptic geometries, and Bolyai-Lobachevsky hyperbolic geometries.
\end{theorem}

The proof of this theorem is short and straightforward, but it requires introducing more technical definitions. Therefore we do not list it here.  

By the Dubrovin-Novikov theorem (\vref{Theorem-Dubrovin-Novikov-1D}), the space of field variables $M$ is Euclidean, so the geodesic convexity is equivalent to convexity in our case. The geodesic convexity is equivalent to the positive semi-definiteness of the covariant Hessian in the torsion-free case. 
