\chapter{Systems of hydrodynamic type:  multi-dimensional case}

\section{Multi-dimensional brackets. Mokhov conditions}

In the case with multi-dimensional bracket
\begin{align}
    \set{I_1,I_2} = \sum_{\alpha = 1}^ d \int \D x 
    \left[ \frac{\delta I_1}{\delta u^p(x)} \left( g^{pq \alpha}(u) \der{}{x^\alpha} + b^{pq\alpha}_s(u) \pder{u^s}{x^\alpha} \right) \frac{\delta I_2}{\delta u^q(x)} \right] \:, \label{eq:multi-dimensional bracket}
\end{align}
we have a set of metrics $g^{ij \alpha}$ and connections $b^{ij \alpha}_k$, where $\alpha = 1 , \cdots, d$. We can again introduce Christoffel symbols defined by
\begin{align}
    b^{i j \alpha}_k = - g^{is \alpha} \Gamma^{j \alpha}_{sk}\:,
\end{align}
(there is no summation over $\alpha$) and the corresponding set of covariant derivatives $\nabla^{\alpha}_j$. The first observation is that these coefficients represent coordinates of a vector under an transformation of the space coordinates $x^\alpha$.
\todo[inline]{Skutečně se mění jenom závislost $u$ na $x^\alpha$, nebo i něco jiného? Může to platit i při nějaké obecné transformaci?}
\begin{proposition}[Transformation of the space coordinates]
    For any changes of the spatial variables $\tilde x^\alpha \coloneqq c^\alpha_\beta x^\beta$, where $\alpha = 1, \cdots, d$ and $\det (c^\alpha_\beta) = 1$, the metrics $g^{ij \alpha}$ and $b^{ij \alpha}_k$ transform as components of a vector.
\end{proposition}

\begin{proof}
    The only variable that changes is $\pder{u^i}{x^\alpha}$
    \begin{align}
        \pder{u^i}{x^\beta} = \pder{u^i}{\tilde x^\alpha} \pder{\tilde x^\alpha}{x^\beta} = \pder{u^i}{\tilde x^\alpha} c^\alpha_\beta \:.
    \end{align}
    Hence
    \begin{align}
        g^{ij \alpha}[u(\tilde x)] = c^\alpha_\beta g^{ij \beta}[u(x)] \:, \quad b^{ij \alpha}_k [u(\tilde x)] = c^\alpha_\beta b^{ij \beta}_k [u(x)] \:.
    \end{align}
\end{proof}


The formulation of the generalized form of the Dubrovin-Novikov theorem (Theorem \vref{Theorem-Dubrovin-Novikov-1D}) is given (without proof) by Mokhov in \cite{Mochov}.

\begin{theorem}[Mokhov conditions]
    A Dubrovin-Novikov bracket \eqref{eq:Dubrovin-Novikov bracket} is a Poisson bracket if and only if the following relations for the coefficients are fulfilled:
    \begin{align}
        g^{ij \alpha} = g^{ji \alpha} \:, \label{eq:Mochov-A} \\
        g^{ij \alpha}_{,k} = b^{ij \alpha}_k + b^{ji \alpha}_k \:, \label{eq:Mochov-B}
    \end{align}
    \begin{align}
        \sum_{(\alpha, \beta)} (g^{mi \alpha} b^{jk \beta}_m - g^{m j \beta} b^{i k \alpha}_m) = 0 \:, \label{eq:Mochov-C}\\
        \sum_{(i,j,k)} (g^{mi \alpha} b^{jk \beta}_m - g^{m j \beta} b^{ik \alpha}_m) = 0 \:, \label{eq:Mochov-D}\\
        \sum_{(\alpha, \beta)} \left[ g^{si \alpha} (b^{jk \beta}_{s,q} - b^{jk \beta}_{q,s} ) + b^{ij \alpha}_s b^{s k \beta}_q - b^{i k \alpha}_s b^{k j \beta}_q \right] = 0 \label{eq:Mochov-E}\:,
    \end{align}
    \begin{align}
        g^{si \beta} b^{j k \alpha}_{q,s} - b^{ij \beta}_s b^{s k \alpha}_q - b^{i k \beta}_s b^{j s \alpha}_q = g^{s j \alpha} b^{i k \beta}_{q,s} - b^{ji \alpha}_s b^{s k \beta}_q - b^{is \beta}_q b^{jk \alpha}_s \label{eq:Mochov-F}\:,
    \end{align}
    \begin{align}
        \pder{}{u^r} \left[ g^{si \alpha} (b^{j k \beta}_{s,q} - b^{j k \beta}_{q,s}) + b^{ij \alpha}_s b^{s k \beta}_q - b^{i k \alpha}_s b^{s j \beta}_q \right] 
        \nonumber \\+ \pder{}{u^q} \left[ g^{si \beta} (b^{j k  \alpha}_{s,k} - b^{j k \alpha}_{r,s}) + b^{ij \beta}_s b^{s k \alpha}_{s,r} + b^{ij \beta}_s b^{s k \alpha}_r - b^{i k \beta}_s b^{k j \alpha}_s \right] \label{eq:Mochov-G}
        \\+ \sum_{(i,j,k)} \left[ b^{si \beta}_q (b^{j k \alpha}_{r,s} - b^{j k \alpha}_{s,r}) + b^{s i \alpha}_r (b^{j k \beta}_{q,s} - b^{j k \beta}_{s,q}) \right] \nonumber
        = 0 \:.
    \end{align}
\end{theorem}
The summations $\sum_{(\alpha, \beta)}$ and $\sum_{(i,j,k)}$ mean summations over all cyclic permutations of the indicated indices. Note that in \eqref{eq:Mochov-C}-\eqref{eq:Mochov-G} the indices $\alpha$ and $\beta$ do not have to be distinct indices (the cyclic permutation $\sum_{(\alpha, \beta)}$ can be ommited in that case). Thus, in particular, we get an important lemma.
\begin{lemma}
    Every summand on the right-side of the multi-dimensional bracket \eqref{eq:multi-dimensional bracket} is one-dimensional Dubrovin-Novikov bracket \eqref{eq:Dubrovin-Novikov bracket 1D}, i.e. each multidimensional bracket of the form \eqref{eq:multi-dimensional bracket} is always the sum of one-dimensional brackets \eqref{eq:Dubrovin-Novikov bracket 1D} with respect to each of the independent variables $x^\alpha$.
\end{lemma}


\begin{remark}
    Let us take once again a closer look to the case of $d=1$ and compare it to the Grinberg conditions (\vref{Grinberg conditions}). The Mokhov conditions are following:
    \begin{align}
        g^{ij} =& g^{ji} \quad &\textbf{(symmetry of metric)} \:, \label{eq:Mochov1D-A}\\
        g^{ij}_{,k} =& b^{ij}_k + b^{ji}_k \quad &\textbf{(compatibility condition)} \label{eq:Mochov1D-B}\:, \\
        g^{mi} b^{jk}_m - g^{mj} b^{ik}_m =& 0 \quad &\textbf{(zero torsion)} \:, \label{eq:Mochov1D-C}\\
        \sum_{(i,j,k)} g^{mi} b^{jk}_m - g^{mj} b^{ik}_m =& 0 \:,\quad& \label{eq:Mochov1D-D}
    \end{align}
    \begin{align}
        g^{si} (b^{jk}_{s,q} - b^{jk}_{q,s}) + b^{ij}_s b^{sk}_q - b^{ik}_s b^{kj}_q = 0 \quad &\textbf{(zero curvature)}\:, \label{eq:Mochov1D-E}
    \end{align}
    \begin{align}
        g^{si} b^{j k}_{q,s} - b^{ij}_s b^{s k}_q - b^{i k}_s b^{j s}_q = g^{s j } b^{i k}_{q,s} - b^{ji}_s b^{s k}_q - b^{is}_q b^{jk}_s \:, \label{eq:Mochov1D-F}\\
        \pder{}{u^r} \left[ g^{si} (b^{j k }_{s,q} - b^{j k}_{q,s}) + b^{ij}_s b^{s k}_q - b^{i k}_s b^{s j}_q \right] 
        \nonumber \\+ \pder{}{u^q} \left[ g^{si } (b^{j k}_{s,k} - b^{j k}_{r,s}) + b^{ij \beta}_s b^{s k}_{s,r} + b^{ij}_s b^{s k}_r - b^{ik}_s b^{kj}_s \right] \label{eq:Mochov1D-G}
        \\+ \sum_{(i,j,k)} \left[ b^{si}_q (b^{j k}_{r,s} - b^{j k}_{s,r}) + b^{s i}_r (b^{j k}_{q,s} - b^{j k}_{s,q}) \right] \nonumber
        = 0 \:.
    \end{align}
    It is evident that \eqref{eq:Mochov1D-D} is just \eqref{eq:Mochov1D-C} with a cyclic permutation hence it holds trivially. It is not so obvious, but also true, that \eqref{eq:Mochov1D-F} follows from the compatibility condition, zero torsion and zero curvature. 
     The last relation \eqref{eq:Mochov1D-G} is the one remaining Grinberg condition \eqref{eq:Grinberg-5}. Only if we assume non-degeneracy, it follows from the zero torsion and curvature, otherwise it must be involved as a separate assumption.
\end{remark}


\section{Tensor obstructions}

\begin{definition}[The obstruction tensors]
    We define the obstruction tensors
    \begin{align}
        T^{i \alpha \beta}_{jk} (u) \coloneqq \Gamma^{i \beta}_{jk}(u) - \Gamma^{i \alpha}_{jk}(u) \:,
    \end{align}
    for each pair of distinct indices $\alpha$ and $\beta$.
\end{definition}
We shall also use their fully contravariant form
\begin{align}
    T^{ijk \alpha \beta}(u) \coloneqq g^{i r \alpha}(u) g^{ks \beta}(u) T^{j \alpha \beta}_{rs} (u) \:.
\end{align}
Note that $T^{i \alpha \beta}_{jk} (u)$ are transformed as tensors only in the upper $\alpha$, $\beta$ indices (since in the remaining they transform as Christoffel symbols).

\begin{lemma} \label{lemma:T=0}
    Non-degenerate Dubrovin-Novikov brackets can be reduced to a constant bracket by a local change of coordinates if and only if all the obstruction tensors $T^{ij \alpha}_{jk}(u)$ are identically equal to zero.
\end{lemma}
\begin{proof}
    For any constant bracket all the connections $\Gamma^{i\alpha}_{jk}(u)$ are equal to zero identically, therefore all obstruction tensors are zero. Conversly, if all the $T^{ij \alpha}_{jk}(u)$ are identically zero, then all the connections $\Gamma^{i\alpha}_{jk}(u)$ are equal to each other. Consequently, they are all zero in any flat coordinates of the metric $g^{ij 1}(u)$. All the remaining metrics $g^{ij \beta}(u)$ are necessarily constant in these coordinates by virtue of compatiblity of the metrics with the corresponding connections.
\end{proof}


\begin{theorem}[Mokhov]
    Flat non-degenerate metrics $g^{ij \alpha}$ define a multidimensional Poisson bracket if and only if the following relations are fulfilled:
    \begin{align}
        T^{ijk \alpha \beta}(u) =& T^{kji \alpha \beta}(u) \:, \label{eq:Mochov-1}\\
        \sum_{(i,j,k)} T^{ijk \alpha \beta}(u) =& 0 \:, \label{eq:Mochov-2}\\
        T^{ij s \alpha \beta}(u) T^{k \alpha \beta}_{st}(u) =& T^{i k s \alpha \beta}(u) T^{j \alpha \beta}_{st} (u) \:, \label{eq:Mochov-3}\\
        \nabla^\alpha_r T^{ijk \alpha \beta}(u) =& 0 \:, \label{eq:Mochov-4}
    \end{align}
    where $\nabla^\alpha_k$ is the Levi-Civita covariant derivative generated by the metric $g^{ij \alpha}(u)$ and $\Gamma^{i \alpha}_{jk}(u)$ are the corresponding Christoffel symbols. 
\end{theorem}

\begin{remark}
    The relations \eqref{eq:Mochov-1} and \eqref{eq:Mochov-3} were found by Dubrovin and Novikov in \cite{Dubrovin-Novikov}. In \cite{Mochov} it was proved that this set of tensor relations is not complete and the remaining two were obtained.
\end{remark}

\begin{proof}
    The first equation \eqref{eq:Mochov-1} reads as
    \begin{align}
        g^{ir \alpha} g^{ks \beta} (\Gamma^{j\beta}_{rs} - \Gamma^{j \alpha}_{rs}) = g^{kr \alpha} g^{is \beta} (\Gamma^{j\beta}_{rs} - \Gamma^{j \alpha}_{rs}) \:,
    \end{align}
    which is equivalent to
    \begin{align}
        \Gamma^{j \beta}_{rs} - \Gamma^{j \alpha}_{rs} = 0 \:,
    \end{align}
    thus follows from \eqref{eq:Mochov-C}.

    The equation \eqref{eq:Mochov-2} is equivalent to \eqref{eq:Mochov-D}, \eqref{eq:Mochov-3} is equivalent to \eqref{eq:Mochov-E}, \eqref{eq:Mochov-4} is equivalent to \eqref{eq:Mochov-F}. The last condition \eqref{eq:Mochov-G} is a direct consequence of the relations \eqref{eq:Mochov-A}-\eqref{eq:Mochov-F} in the non-degenerate case.
    \todo[inline]{Je potřeba to rozepisovat podrobněji?}
\end{proof}

\begin{example}[Classification of one-component brackets]
    

It is not complicated to obtain a complete classification of all one-component brackets
\begin{align}
    \pder{u}{t} = \left( g^{\alpha}(u) \pder{^2h}{u^2} + b^{\alpha}(u) \pder{h}{u} \right) \pder{u}{x^\alpha} \:, \quad \alpha = 1, \cdots, d \:.
\end{align}
The multi-dimensional bracket is 
\begin{align}
    \set{u(x),u(y)} = g^{\alpha}(u) \partial_\alpha \delta(x-y) + b^\alpha(u) \delta(x-y) \:.
\end{align}
and the decomposition is
\begin{align}
    b^\alpha = - g^\alpha \Gamma^\alpha \:.
\end{align}
The Mokhov conditions \eqref{eq:Mochov-A}, \eqref{eq:Mochov-C}, \eqref{eq:Mochov-E} and \eqref{eq:Mochov-G} are automatically fulfilled. The relations \eqref{eq:Mochov-B} and \eqref{eq:Mochov-D} are
\begin{align}
    \pder{g^\alpha}{u} = 2 b^\alpha(u) \:, \label{eq:1comp-1} \\
    g^\alpha(u) b^\beta(u) = g^\beta(u) g^\alpha(u) \label{eq:1comp-2}\:.
\end{align}
The last condition \eqref{eq:Mochov-F} follows from them. If we apply \eqref{eq:1comp-1} into \eqref{eq:1comp-2}, we get
\begin{align}
    \frac{1}{g^\alpha} \pder{g^\alpha}{u}= \frac{1}{g^\beta}\pder{g^\beta}{u} \:,
\end{align}
hence
\begin{align}
    g^\alpha(u) = 2c^\alpha g(u) \:, \quad b^\alpha(u) = c^\alpha \quad \forall \alpha = 1, \cdots d \:,
\end{align}
where $c^\alpha$ are arbitrary constants.
Thus, for $g(u) \neq 0$ all the obstruction tensors are identically zero:
\begin{align}
    T^{\alpha \beta} = \Gamma^\beta - \Gamma^\alpha = -\frac{b^\alpha}{g^\alpha} + \frac{b^\beta}{g^\beta} = - \frac{1}{2 g} + \frac{1}{2g} = 0 \:.
\end{align}
By the virtue of lemma \vref{lemma:T=0} by local changing of coordinates we can always find a transform in witch the bracket has a constant form. The 
\begin{align}
    \pder{w}{t} = \eta^\alpha \pder{w}{x^\alpha} \:.
\end{align}

The degenerate case is also trivial. If for some $\alpha$ is $g^\alpha(u) = 0$, then from \eqref{eq:Mochov-B} follows $b^\alpha(u) = 0$.

\end{example}

\section{Compatible brackets}

In this section we introduce the theory of compatible metrics constructed by Mochov in \cite{Mochov} and show that the study of non-degenerate multi-dimensional brackets is connected to the study of compatible one-dimensional brackets. 

\begin{definition}[Compatible metrics]
    Let $g^{ij1}(u)$ and $g^{ij2}(u)$ be non-degenerate psudo-Riemannian metrics with Levi-Civita connections $\Gamma^{ij1}_k(u)$, $\Gamma^{ij2}_k(u)$. We say that $g^{ij1}$ and $g^{ij2}$ are compatible if for any linear combination of these metrics
    \begin{align}
        g^{ij}(u) = \lambda_1 g^{ij1}(u) + \lambda_2 g^{ij2}(u) \:,
    \end{align}
    where $\lambda_{1,2}$ are arbitrary constant such that $\det g^{ij} \neq 0$, the coefficients of the corresponding Levi-Civita connections and the components of the corresponding Riemann tensors are related by the same linear formula:
    \begin{align}
        \Gamma^{ij}_k = \lambda_1 \Gamma^{ij1}_k + \lambda_2 \Gamma^{ij2}_k \:, \label{eq:compatible-Gamma}\\
        R\indices{_a_b^k_c} = \lambda_1 R\indices{_a_b^k_c^1} + \lambda_2 R\indices{_a_b^k_c^2} \label{eq:compatible-R}\:.
    \end{align}
    If for any linear combination of metrics only \eqref{eq:compatible-Gamma} is fulfilled, then the metrics are called almost compatible.
\end{definition}


\begin{definition}[Compatible Poisson brackets]
    We say that two Poisson brackets are compatible if each their linear combination is a Poisson bracket.
\end{definition}

\begin{definition}[L-affinor]
    Let $g^{ij1}(u)$ and $g^{ij2}(u)$ be two metrics.
    We define the L-affinor $L^i_j$ by
    \begin{align}
        L^i_j(u) = g^{ik2}(u) g_{kj1}(u) \:,
    \end{align}
\end{definition}

\begin{theorem}[Vanishing of the Nijenhuis tensor]
    The metrics $g^{ij1}(u)$ and $g^{ij2}(u)$ are almost compatible if and only if the Nijenhuis tensor of the L-affinor is zero, i.e.
    \begin{align}
        N^i_{jk} \coloneqq L^s_j L^{i}_{k,s} - L^s_k L^{i}_{j,s} - L^i_s L^s_{k,j} - L^i_s L^s_{j,k} = 0 \:.
    \end{align}
\end{theorem}

Note that that there are examples of metrics that are only almost compatible, but not compatible, and for which the Nijenhuis tensor is zero \cite{Mokhov-compatibility}. 

\begin{theorem}[Mutual compatibility of the metrics]
    All metrics $g^{ij \alpha}(u)$, $1 \leq \alpha \leq N$, defining a multi-dimensional Poisson bracket \eqref{eq:multi-dimensional bracket} are mutually compatible. All one-dimensional Dubrovin-Novikov brackets forming a multi-dimensional bracket are mutually compatible.
\end{theorem}
\todo[inline]{Podívat se na důkaz tohoto.}
\begin{proof}
    The equation \eqref{eq:Mochov-1} is equivalent to \eqref{eq:Mochov-C} and also to the vanishing of the obstruction tensor, witch means
    \begin{align}
        \Gamma^{i\alpha}_{jk} = \Gamma^{i \beta}_{jk} \:.
    \end{align}
    Hence their linear combination is also Levi-Civita connection for the same linear combination of metrics.
    The equation \eqref{eq:Mochov-3} is equivalent to \eqref{eq:Mochov-E} and thus to
    \begin{align}
        R\indices{_a_b^k_l^\alpha} =  R\indices{_a_b^k_l^\beta} \:.
    \end{align}
\end{proof}

\begin{theorem}[Mokhov classification theorem]
    If for a nondegenerate multidimensional Poisson bracket one of the metrics $g^{ij \alpha}(u)$ forms nonsingular pairs with all the remaining metrics, i.e.
    \begin{align}
        \:,
    \end{align}
    then this Poisson bracket can be reduced to a constant form by a local change of coordinates.
\end{theorem}

\begin{proof}
    \todo{inline}[podívat se na důkaz]
\end{proof}

